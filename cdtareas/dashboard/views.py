from django.shortcuts import render_to_responsefrom django.template import RequestContextfrom django.contrib.auth.forms import UserCreationForm, AuthenticationFormfrom django.contrib.auth import login, authenticate, logoutfrom django.contrib.auth.decorators import login_requiredfrom django.http import HttpResponse, HttpResponseRedirectfrom forms import *@login_required(login_url='/login')def index(request):	return render_to_response('index.html', locals(),		  context_instance=RequestContext(request))    def nuevo_usuario(request):    if request.method=='POST':        formulario = RegisterForm(request.POST)        if formulario.is_valid():            usuario = formulario.save(commit=False)            usuario.is_active = 0            usuario.save()            return HttpResponseRedirect('/')    else:        formulario = RegisterForm()    return render_to_response('usuario/registro.html',    	{'formulario':formulario},     	context_instance=RequestContext(request))def ingresar(request):    if request.method == 'POST':        formulario = AuthenticationForm(request.POST)        if formulario.is_valid:            usuario = request.POST['username']            clave = request.POST['password']            acceso = authenticate(username=usuario, password=clave)            if acceso is not None:                if acceso.is_active:                    login(request, acceso)                    return HttpResponseRedirect('/')                else:                    return render_to_response('usuario/noactivo.html',                         context_instance=RequestContext(request))            else:                error = u'invalid login'                return render_to_response('usuario/login.html',                    {'formulario':formulario,                    'error':error},                     context_instance=RequestContext(request))    else:        formulario = AuthenticationForm()    return render_to_response('usuario/login.html',        {'formulario':formulario},         context_instance=RequestContext(request))@login_required(login_url='/ingresar')def privado(request):    usuario = request.user    return render_to_response('privado.html',         {'usuario':usuario},         context_instance=RequestContext(request))@login_required(login_url='/login')def cerrar(request):    logout(request)    return HttpResponseRedirect('/')